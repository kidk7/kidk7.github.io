<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Yam Archive</title>
  <style>
    body { font-family: 'Arial', sans-serif; margin: 0; background: #fffbe7; color: #4e3900; }
    header {
      background: #ffda3c; color: #4e3900;
      border-bottom: 3px solid #ecc700;
      box-shadow: 0 2px 8px rgba(255,218,60,0.15);
      position: relative; padding: 32px 0 24px 0; margin-bottom:0;
      display:flex; justify-content:center; align-items:center;
    }
    #siteName {
      display: inline-block;
      font-weight: 800; font-size: 2em;
      letter-spacing: 2px; text-align:center;
      border: 3.5px solid #e7be17;
      border-radius: 18px; padding: 14px 40px;
      background:#fffde8;
      box-shadow:0 2px 14px rgba(255,220,70,0.18);
      position: relative;
    }
    .header-right {
      position: absolute; right: 5vw; top: 32px; display: flex; gap: 10px;
      font-size: 0.96em;
    }
    .header-link {
      background: none; color: #ad8e01; font-weight: 650; border: none; padding: 3px 8px;
      border-radius: 5px; text-decoration: none; cursor: pointer;
      font-size: 0.93em; margin-left: 2px; transition: color 0.18s;
    }
    .header-link:hover { color: #d5ad00; background: #fff3c2; }
    /* í•„í„° ì˜ì—­ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .filter-bar {
      background: #fff2b2;
      display: flex;
      justify-content: center;
      gap: 22px;
      padding: 14px 0 13px 0;
      border-bottom: 1.5px solid #fded8d;
      margin: 0 auto 6px auto;
      max-width: 700px;
    }
    .filter-bar button {
      background: #ffe065; border: none; border-radius: 7px;
      padding: 10px 22px; cursor: pointer; font-weight: 700; color: #855900;
      font-size: 1.05rem; margin-bottom: 5px; transition: background 0.2s, color 0.2s;
    }
    .filter-bar button:hover, .filter-bar button.active {
      background: #ffe998; color: #d5ad00; outline: 2px solid #ffe065;
    }
    .filter-tags-center {
      max-width: 700px;
      margin: 0 auto 24px auto;
      gap: 22px; /* ê°„ê²© í†µì¼ */
    }
    /* ë­í‚¹ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    #rankingBox {
      position: absolute;
      left: 20px;
      top: 85px;
      z-index: 210;
      background: #fffbe7;
      border: 2px solid #e7be17;
      border-radius: 12px;
      padding: 20px 24px;
      box-shadow: 0 2px 14px rgba(255,220,70,0.14);
      min-width: 170px;
      font-family: 'Arial', sans-serif;
      font-size: 0.95em;
      color: #856300;
    }
    #rankingBox h4 {
      margin: 0 0 10px 0;
      color: #ad8e01;
      font-weight: 700;
    }
    #rankingList {
      margin: 0;
      padding-left: 18px;
    }
    #restaurantList { max-width: 660px; margin: 0 auto 24px auto; background: #fffde8;
      padding: 25px 22px; border-radius: 12px; box-shadow: 0 2px 13px rgba(255,215,57,0.13);}
    ul.restaurants { list-style: none; padding: 0; margin: 0; }
    .restaurant-item {
      display: flex; align-items: center; gap: 18px;
      border-bottom: 1px solid #fee975; padding: 18px 0;
      transition: background 0.2s; min-height: 110px; cursor: pointer;
    }
    .restaurant-item:last-child { border-bottom: none; }
    .thumb { width: 80px; height: 80px; object-fit: cover; border-radius: 10px; box-shadow: 0 1px 3px rgba(240,185,55,0.12);}
    .dish-thumb { width: 70px; height: 70px; object-fit: cover; border-radius: 9px; box-shadow: 0 1px 3px rgba(245,190,51,0.13);}
    .info-block { display: flex; flex-direction: column; gap: 8px; flex: 1 1 0%; }
    .restaurant-name { font-size: 1.18em; font-weight: 700; }
    .dish-name { font-size: 0.95em; font-weight: 450; color: #c98800; margin-top: 5px;}
    .modal-bg {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background:rgba(60,50,10,0.24);
      display:flex; align-items: center; justify-content: center; z-index: 1001;
    }
    .modal-box {
      background: #fffde8; min-width: 320px; max-width: 92vw; padding: 28px 34px 19px 34px;
      border-radius:16px; box-shadow: 0 10px 32px rgba(80,60,0,0.19); position: relative;
      display: flex; flex-direction: column; align-items: center; text-align: center;
    }
    .modal-box h3 { margin: 6px 0 11px 0; font-size:1.34em; color: #be9003;}
    .modal-box img { width: 110px; height: 110px; object-fit: cover; border-radius: 13px; margin-bottom: 20px; }
    .modal-box .addrs { font-size:1.04em; color: #666500; margin: 3px 0 7px 0; }
    .modal-box .menus { font-weight: 600; margin-top: 10px; font-size: 1.07em;}
    .close-btn {
      position: absolute; top: 7px; right: 15px; background: #ffd700; border: none;
      color: #874c00; font-size: 1.5em; cursor:pointer; border-radius: 50%; width: 33px; height: 33px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <span id="siteName">Yam Archive</span>
    <div class="header-right">
      <a href="#" class="header-link" style="font-size:0.97em;">ë¡œê·¸ì¸</a>
      <a href="#" class="header-link" style="font-size:0.97em;">ê³ ê°ì„¼í„°</a>
    </div>
  </header>

  <!-- ë­í‚¹ ë°•ìŠ¤ -->
  <div id="rankingBox">
    <h4>ğŸ½ï¸ ì¸ê¸° ë­í‚¹</h4>
    <ol id="rankingList"></ol>
  </div>

  <!-- ìœ„ì¹˜ í•„í„° -->
  <nav id="categoryBar" class="filter-bar">
    <button class="active" data-cat="ê±´ëŒ€ì…êµ¬">ê±´ëŒ€ì…êµ¬</button>
    <button data-cat="ì¤‘ë¬¸">ì¤‘ë¬¸</button>
    <button data-cat="í›„ë¬¸">í›„ë¬¸</button>
    <button data-cat="ì–´ë¦°ì´ëŒ€ê³µì›">ì–´ë¦°ì´ëŒ€ê³µì›</button>
  </nav>

  <!-- ì‹ë‹¨ í•„í„° -->
  <nav class="filter-bar filter-tags-center">
    <button class="tag-btn" data-tag="vegan">ë¹„ê±´</button>
    <button class="tag-btn" data-tag="halal">í• ë„</button>
    <button class="tag-btn" data-tag="glutenfree">ê¸€ë£¨í…í”„ë¦¬</button>
    <button class="tag-btn" data-tag="under10k">ë§Œì›ì´í•˜</button>
  </nav>

  <section id="restaurantList"></section>
  <div id="modalBg" class="modal-bg" style="display:none">
    <div class="modal-box">
      <button class="close-btn" onclick="closeModal()">&times;</button>
      <img id="modalImg" src="" alt="" />
      <h3 id="modalName"></h3>
      <div class="addrs" id="modalAddr"></div>
      <div class="menus" id="modalMenus"></div>
    </div>
  </div>

<script>
  const WHITE_IMG = "https://via.placeholder.com/80x80/FFFFFF/FFFFFF?text=+";
  const WHITEMENU_IMG = "https://via.placeholder.com/70x70/FFFFFF/FFFFFF?text=+";
  function safeImg(str, fallback) { return str && str.length>10 ? str : fallback; }
  function safeMenuImgs(arr) { return (Array.isArray(arr)&&arr.length&&arr[0].length>10) ? arr : [WHITEMENU_IMG]; }

  const dishes = [
    "ë¹„ë¹”ë°¥", "ìš°ë™", "ì´ˆë°¥", "ë‹­í•œë§ˆë¦¬", "ê¹Œë¥´ë³´ë‚˜ë¼", "ìŠ¤í…Œì´í¬", "ì§¬ë½•", "ëˆì¹´ì¸ ", "ì•„ë©”ë¦¬ì¹´ë…¸"
  ];

  // ì‹ë‹¹ í´ë¦­ìˆ˜ ì§‘ê³„ìš© ê°ì²´
  let restaurantClicks = {};

  function appendRestaurants(list, desc, imgList, tagsList=[]) {
    return list.map((name, idx) => {
      restaurantClicks[name] = 0; // í´ë¦­ìˆ˜ ì´ˆê¸°í™”
      return {
        name,
        menu: desc[idx % desc.length],
        addr: "-",
        img: imgList && imgList[idx] ? imgList[idx] : WHITE_IMG,
        menuimgs: [WHITEMENU_IMG],
        tags: tagsList[idx] || []
      };
    });
  }

  const kunUniImgs = [
    "https://search.pstatic.net/common/?src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20171222_273%2F1513909993152wbpV8_JPEG%2FfM-4sk2LkYUe0jmd83plu51X.JPG.jpg",
    "https://search.pstatic.net/common/?src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20221105_150%2F1667640635518fdmMX_JPEG%2F01_%BE%D7%BC%C7%C4%C6-6.jpg",
    "", "", "",
    "", "", "", "", "",
    "", "", "", "", "",
    "", "", "", "", ""
  ];

  const data = {
    "ê±´ëŒ€ì…êµ¬": appendRestaurants([
      "ì†¡í™”ì‚°ì‹œë„ì‚­ë©´", "ì •ë©´ ê±´ëŒ€", "ëª¨ì¸ ì»¤í”¼ ê±´ëŒ€", "í•˜ì´ë””ë¼ì˜¤ ê±´ëŒ€ì ", "ìš°ë§ˆì´ë„ ê±´ëŒ€ì ",
      "ë¯¸ë¶„ë‹¹ ê±´ëŒ€", "ê³„íƒ„ì§‘", "í•µë°¥ ê±´ëŒ€ì ", "ë°±ì†Œì • ê±´ëŒ€ë³¸ì ", "ê³ ë² ê·œì¹´ì¸  ê±´ëŒ€ë³¸ì ",
      "ì„±ìˆ˜ì™„ë‹¹ ë³¸ì ", "ì˜¤ìœ ë¯¸ë‹¹ ê±´ëŒ€ì ", "í™”ê¸°ì• ì•  ë³¸ì ", "ê³ í¥ìˆœëŒ€êµ­", "ë¯¼ì •ì‹ë‹¹",
      "ë•ê°ìíƒ• ì „ë¬¸ì ", "ì•„ì°Œë–¡ë³¶ì´", "í•¨í¥ë³¸ê°€ë©´ì˜¥ ê±´ëŒ€ì ", "ë™í•´í•´ë¬¼", "ë” í´ë˜ì‹ 500 ë¼êµ¬ëœ¨"
    ], dishes, kunUniImgs, [
      ["vegan"], [], ["vegan", "under10k"], [], [],
      ["glutenfree"], [], ["vegan", "under10k"], [], [],
      ["halal"], [], [], [], ["under10k"],
      [], [], [], [], []
    ]),
    "ì¤‘ë¬¸": appendRestaurants([
      "ë‘ì°œ ê±´ëŒ€ì ", "ì •ë©´ êµ­ìˆ˜", "ë‚´ê°€ì°œí•œë‹­ ê±´êµ­ëŒ€ì ", "í˜„ì´ë„¤ ê³ ê¸°êµ­ìˆ˜", "ì œì£¼ê³¤ì´ì¹¼êµ­ìˆ˜ ê±´ëŒ€ì ",
      "ì­ˆê¾¸ë¯¸í‚¹ ê±´ëŒ€ì ", "ì–´ë©ë„¤ê³ ê¸°êµ­ìˆ˜", "í–‰ì»µ ê±´êµ­ëŒ€ì ", "ì¥ì¸ë‹­ê°ˆë¹„ ê±´ëŒ€ì ", "ì¶˜ì²œì§‘ ëª…ê°€ ë‹­ê°ˆë¹„",
      "ì¢…ë¡œë¹ˆëŒ€ë–¡ ì‹ ì‚¬ì—…9í˜¸ì ", "íŒ”ê°ë„ ê±´ëŒ€ì ", "ê±´êµ­ëŒ€ í•™ì‹(í•™ìƒíšŒê´€)", "ë¶ˆë§‰ì—´ì‚¼ ê±´ëŒ€ì ", "ì´í™”",
      "ê±´ëŒ€ ìˆ¯ë¶ˆë¶€ìê³±ì°½", "ê°•ìŠ¹í˜¸ìƒë©´", "í™ì¶˜ì²œì¹˜ì¦ˆë‹­ê°ˆë¹„", "ë§ˆë¼ê³µë°©", "ë”ë²¤í‹° ê±´ëŒ€ì¤‘ë¬¸ì "
    ], dishes, [], []),
    "í›„ë¬¸": appendRestaurants([
      "ì‹œí™ì“° ê±´ëŒ€", "ìƒˆë¡œì´ ê±´ëŒ€", "ë˜ë¹—í™€ ë²„ê±°ì»´í¼ë‹ˆ ê±´ëŒ€", "ì•Œì´Œ ê±´êµ­ëŒ€ì ", "ë„ë„ì‚¼ê²¹",
      "ëª½ê¸€ëª½ê¸€ ë‘ë¶€ìš”ë¦¬", "ë¶€ëŒ€ì‚¬ë‘", "ìœ„ë½ë°¥ì§‘", "ë™ê¶ì°œë‹­ ê±´ëŒ€ê´‘ì§„ì ", "í†µí°ê°ìíƒ• ê±´ëŒ€ë³¸ì ",
      "ë†€ë¶€ë¶€ëŒ€ì°Œê°œ ê±´ëŒ€ìŠ¤íƒ€ì‹œí‹°ì ", "í—¬ë¡œìš°ë‚™ê³±ìƒˆêµ°ìì ", "ì˜¤ë§ˆì¹´ì„¸ ì˜¤ì‚¬ì´ì´ˆë°¥ ê±´ëŒ€ë³¸ì ", "ë¯¸ë„ì¸ ê±´ëŒ€", "ì½”í›„ì¿  ì´ìì¹´ì•¼",
      "ê°€ì¸ ì‹œ", "ëˆ„ë“¤ì•„í•œíƒ€ì´", "ë„ì¿„420", "ê±´ëŒ€ì‚¬ì‹œë¯¸", "ì™•ì‹­ë¦¬ì •ê³±ì°½ ì–´ë¦°ì´ëŒ€ê³µì›ì—­"
    ], dishes, [], []),
    "ì–´ë¦°ì´ëŒ€ê³µì›": appendRestaurants([
      "ì—ì´ë¿”ë¨ êµ°ìì ", "ìˆ˜í¼ìŠ¬ë¼ì´ë”ìŠ¤", "í˜¼ë‹¤ë¼ë©˜", "ì´ˆë¼ë©˜", "ê¾¸ì•„ ê±´ëŒ€ì ",
      "ì˜¤ë§ˆì¹´ì„¸ ì˜¤ì‚¬ì´ì´ˆë°¥ ê±´ëŒ€ë³¸ì ", "ë©•ì‹œì¹¼ë¦¬", "ì´ì´ìš”", "ì†Œë°”ì¿ ", "ë¹ ì˜¤ì¦ˆí‘¸ ë³¸ì ",
      "ë˜ë¹—í™€ ë²„ê±°ì»´í¼ë‹ˆ ê±´ëŒ€", "ë¸Œë„¤ ì–´ë¦°ì´ëŒ€ê³µì›ì—­", "ì™•ì†Œêµ¬ì´ ê±´ëŒ€", "ì¬í¬ë„¤ì‹ë‹¹ ê±´ëŒ€", "ë‚´ë‹´ ì„¸ì¢…ëŒ€ì ",
      "í•œì†¥ë„ì‹œë½ ê±´ëŒ€", "ë§ˆì´ˆì‰í”„ ê±´ëŒ€ì ", "ë¯¸ë„ì¸ ê±´ëŒ€", "ì˜¥ë£¨ëª½ ì–´ë¦°ì´ëŒ€ê³µì›ì ", "ëª½ë””ì €íŠ¸"
    ], dishes, [], []),
  };

  let currentCategory = "ê±´ëŒ€ì…êµ¬";
  let currentDietTags = [];

  // ìœ„ì¹˜ í•„í„° ë²„íŠ¼ ì´ë²¤íŠ¸
  const locationButtons = document.querySelectorAll('#categoryBar button');
  locationButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      locationButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentCategory = btn.dataset.cat;
      renderRestaurants(currentCategory, currentDietTags);
    });
  });

  // ì‹ë‹¨ í•„í„° ë²„íŠ¼ ì´ë²¤íŠ¸ (í† ê¸€)
  const dietButtons = document.querySelectorAll('.filter-tags-center button');
  dietButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const tag = btn.dataset.tag;
      const idx = currentDietTags.indexOf(tag);
      if (idx > -1) {
        currentDietTags.splice(idx, 1);
        btn.classList.remove('active');
      } else {
        currentDietTags.push(tag);
        btn.classList.add('active');
      }
      renderRestaurants(currentCategory, currentDietTags);
    });
  });

  // í•„í„° ì ìš©í•´ì„œ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
  function filterRestaurants(loc, dietTags) {
    let list = data[loc] || [];
    if (dietTags.length === 0) return list;
    return list.filter(r => dietTags.every(tag => r.tags.includes(tag)));
  }

  // í´ë¦­ìˆ˜ ì§‘ê³„ìš© ê°ì²´ëŠ” ì´ë¯¸ ìƒì„±ë¨

  // ë­í‚¹ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
  function updateRanking() {
    const rankingArr = Object.entries(restaurantClicks)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10);
    const rankingList = document.getElementById('rankingList');
    rankingList.innerHTML = "";
    rankingArr.forEach(([name, count]) => {
      const li = document.createElement('li');
      li.textContent = `${name} (${count}íšŒ)`;
      rankingList.appendChild(li);
    });
  }

  // ì‹ë‹¹ ëª©ë¡ ê·¸ë¦¬ê¸°
  function renderRestaurants(category, dietTags) {
    const container = document.getElementById('restaurantList');
    container.innerHTML = "";
    const list = filterRestaurants(category, dietTags);

    if (!list.length) {
      container.innerHTML = "<p>í•´ë‹¹ ì¡°ê±´ì— ë§ëŠ” ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
      return;
    }
    const ul = document.createElement('ul');
    ul.className = "restaurants";

    list.forEach(d => {
      const li = document.createElement('li');
      li.className = "restaurant-item";
      li.innerHTML = `
        <img class="thumb" src="${safeImg(d.img, WHITE_IMG)}" alt="${d.name}">
        <div class="info-block">
          <div class="restaurant-name">${d.name}</div>
          <div class="dish-name">${(d.menu || '').split(',')[0]}</div>
        </div>
        <img class="dish-thumb" src="${safeMenuImgs(d.menuimgs)}" alt="ëŒ€í‘œ ë©”ë‰´ ì‚¬ì§„">
      `;
      li.onclick = () => {
        restaurantClicks[d.name]++;
        updateRanking();
        showModal(d);
      };
      ul.appendChild(li);
    });

    container.appendChild(ul);
  }

  // ëª¨ë‹¬ ì—´ê¸°
  function showModal(d) {
    document.getElementById('modalImg').src = safeImg(d.img, WHITE_IMG);
    document.getElementById('modalName').innerText = d.name;
    document.getElementById('modalAddr').innerHTML = "ì£¼ì†Œ: " + (d.addr || "ì •ë³´ ì—†ìŒ");
    document.getElementById('modalMenus').innerHTML = "ëŒ€í‘œë©”ë‰´: " + d.menu;
    document.getElementById('modalBg').style.display = "flex";
  }

  function closeModal() {
    document.getElementById('modalBg').style.display = "none";
  }

  document.getElementById('modalBg').onclick = function (e) {
    if (e.target === this) closeModal();
  };

  renderRestaurants(currentCategory, currentDietTags);
  updateRanking();
</script>
</body>
</html>
